resources:
  - name: code_analysis_resource
    type: CodeAnalysis
    configuration:
      integration: sonar_int
  - name: code_gitrepo
    type: GitRepo
    configuration:
      path: creepy-pirate/jfrog-pipelines-test-yamls
      gitProvider: deepak_git
      branches:
        include: master

pipelines:
  - name: code_analysis_pipe
    configuration:
      jfrogCliVersion: 2
      environmentVariables:
        readOnly:
          env2: "test_p2"
    steps:
      - name: pre_step
        type: Bash
        configuration:
          outputResources:
              - name: code_analysis_resource
        execution:
          onExecute:
            - echo "Ran Code analysis step 1"
      - name: trigger_1
        type: Bash
        configuration:
          inputResources:
              - name: code_gitrepo
          outputResources:
              - name: code_analysis_resource
        execution:
          onExecute:
            - echo "Ran Code analysis step 2"
           
      # - name: trigger_2
      #   type: Bash
      #   configuration:
      #     affinityGroup: trigger
      #     timeoutSeconds: 5
      #     inputSteps:
      #       - name: pre_step
      #   execution:
      #     onExecute:
      #       - echo $resource_new_2_path
